<!DOCTYPE html>
<html lang="en" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>لیست لغت ها</title>
  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="./assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="./assets/css/Vazir-Code.css" />
  <style>
    .syllable-display {
      margin-top: 20px;
      font-size: 1.2em;
      white-space: nowrap; /* جلوگیری از شکستن خط */
      font-family: 'Vazir Code';
      direction: ltr;
      text-align: left;
    }
    .result {
      text-align: right;
    }
    
    td .bi-check-circle-fill {
      color: #2fa02f;
    }

    .input-group {
      direction: ltr;
    }

    .input-group * {
      direction: rtl;
    }

    .nav-link {
      font-family: system-ui;
      font-size: 26px;
    }
  </style>
</head>
<body style="text-align: center;">
  <!-- هدر -->
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="./index.html">تحلیل شعر <span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item active">
          <a class="nav-link" href="./list-words.html">لیست کلمات</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="./about.html">درباره ما</a>
        </li>
      </ul>
    </div>
  </nav>
  <div class="container mt-5">
    <h2 class="text-center">کلمات و هجای آن‌ها</h2>
    <h2 class="count-word">تعداد کل کلمات: </h2>
    <h2 class="count-word-need">تعداد کلمات مورد نیاز: </h2>
    <h2 class="count-word-accept">تعداد کلمات تایید شده: </h2>
    <h2 class="count-word-not-accept">تعداد کلمات تایید نشده: </h2>
    <h2 class="count-word-dont-need">تعداد کلمات خارج از لیست: </h2>
    
    <div class="row mb-3">
      <div class="col-md-6">
        <label for="filterInput">جستجوی کلمه:</label>
        <input type="text" id="filterInput" placeholder="جستجوی کلمه..." class="form-control" />
      </div>
      <div class="col-md-6">
        <label for="weightFilterInput">جستجوی وزن:</label>
        <div class="input-group">
          <select class="custom-select" id="weightUnitSelect" onclick="choseWeight()">
            <!-- گزینه‌ها به صورت داینامیک اضافه می‌شوند -->
          </select>
          <input type="text" id="weightFilterInput" placeholder="جستجوی وزن..." class="form-control" />
        </div>
      </div>
    </div>
    
    <button class="btn btn-primary mb-3 mt-3" onclick="showChoseWord()">
      جمع آوری کلمات
    </button>
    
    <table class="table table-bordered">
        <thead>
            <tr>
                <th></th>
                <th>کلمه</th>
                <th>هجای آن</th>
                <th>تایید</th>
            </tr>
        </thead>
        <tbody id="wordListBody">
            <!-- می‌توانید کلمات بیشتری اضافه کنید -->
        </tbody>
    </table>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th></th>
                <th>کلمه</th>
                <th>هجای آن</th>
                <th>تایید</th>
            </tr>
        </thead>
        <tbody id="wordListBody2">
            <!-- می‌توانید کلمات بیشتری اضافه کنید -->
        </tbody>
    </table>
  </div>
  
  <script src="./assets/js/word-list-dont-need.js"></script>
  <script src="./assets/js/check-poem.js"></script>
  <script>
    function printWords() {
      const inputText = document.querySelector('#filterInput');
      const weightInput = document.querySelector('#weightFilterInput');
      const filterValue = inputText.value.toLowerCase();
      const weightFilterValue = weightInput.value.toUpperCase();
      
      const htmlList = Object.keys(wordList)
        .filter((item) => {
          // فیلتر بر اساس کلمه
          const matchesWord = item.includes(filterValue);
          // فیلتر بر اساس baseWordShape
          let matchesWeight = true;
          if(weightInput.value !== '') {
            const shape = getShapeOfWord(wordList[item]);
            matchesWeight = shape == weightFilterValue;
          }
          
          return matchesWord && matchesWeight;
        })
        .map((item, key) => `<tr>
          <td>${key + 1}</td>
          <td>${item}</td>
          <td>${wordList[item].join(' + ')}</td>
          <td>
            <input name="word" value="${item}" type="checkbox" />
            ${acceptWordList[item] != null ? `<img width="20" src="./assets/images/check.png" />` : ``}
          </td>
      </tr>`).join('');
      
      document.querySelector('#wordListBody').innerHTML = htmlList;
    }

    function printWords2() {
      const inputText = document.querySelector('#filterInput');
      const weightInput = document.querySelector('#weightFilterInput');
      const filterValue = inputText.value.toLowerCase();
      const weightFilterValue = weightInput.value.toUpperCase();
      
      const htmlList = Object.keys(wordListDontNeed)
        .filter((item) => {
          // فیلتر بر اساس کلمه
          const matchesWord = item.includes(filterValue);
          // فیلتر بر اساس baseWordShape
          let matchesWeight = true;
          if(weightInput.value !== '') {
            const shape = getShapeOfWord(wordListDontNeed[item]);
            matchesWeight = shape == weightFilterValue;
          }
          
          return matchesWord && matchesWeight;
        })
        .map((item, key) => `<tr>
          <td>${key + 1}</td>
          <td>${item}</td>
          <td>${wordListDontNeed[item].join(' + ')}</td>
          <td>
            <input name="word" value="${item}" type="checkbox" />
            ${acceptWordList[item] != null || true ? `<img width="20" src="./assets/images/check.png" />` : ``}
          </td>
      </tr>`).join('');
      
      document.querySelector('#wordListBody2').innerHTML = htmlList;
    }

    printWords();
    printWords2();
    addBaseWordToSelect();
  
    document.querySelector('.count-word').innerHTML = `تعداد کل کلمات: ${Object.keys(wordList).length + Object.keys(wordListDontNeed).length}`;
    document.querySelector('.count-word-need').innerHTML = `تعداد کلمات مورد نیاز: ${Object.keys(wordList).length}`;
    document.querySelector('.count-word-accept').innerHTML = `تعداد کلمات تایید شده: ${Object.keys(acceptWordList).length}`;
    document.querySelector('.count-word-not-accept').innerHTML = `تعداد کلمات تایید نشده: ${Object.keys(wordList).length - Object.keys(acceptWordList).length}`;
    document.querySelector('.count-word-dont-need').innerHTML = `تعداد کلمات خارج از لیست: ${Object.keys(wordListDontNeed).length}`;
    

    function showChoseWord() {
      const inputList = document.querySelectorAll('[type="checkbox"]');
      const result = [...inputList].filter((input) => input.checked).map((item) => item.value).join('\n');
      navigator.clipboard.writeText(result);
      // console.log('Content copied to clipboard');
      alert('Copy below text to clipboard. \n'+result);
    }

    function addBaseWordToSelect() {
      // انتخاب عنصر سلکت
      const selectElement = document.getElementById('weightUnitSelect');
      const weightInput = document.querySelector('#weightFilterInput');
      selectElement.innerHTML = '<option selected>وزنی انتخاب نشده</option>';
      // اضافه کردن گزینه‌ها به سلکت
      for (const key in baseWord) {
          const option = document.createElement('option');
          option.value = key;
          const shape = baseWordShape[key];
          option.textContent = key+' = '+ shape; // متن گزینه
          if(weightInput.value.toUpperCase() == shape)
          {
            option.selected = true;
          }
          selectElement.appendChild(option);
      }
    }

    function choseWeight()
    {
      const selectElement = document.getElementById('weightUnitSelect');
      const weightInput = document.querySelector('#weightFilterInput');
      const chose = selectElement.value;
      weightInput.value = baseWordShape[chose] ?? '';
      printWords();
      printWords2();
    }

    // فیلتر کردن کلمات
    document.getElementById('filterInput').addEventListener('input', function() {
      printWords();
      printWords2();
      addBaseWordToSelect();
    });

    document.getElementById('weightFilterInput').addEventListener('input', function() {
      printWords();
      printWords2();
      addBaseWordToSelect();
    });
  </script>

  <!-- Bootstrap JS (optional) -->
  <!-- <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script> -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script> -->
  <!-- <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script> -->
</body>
</html>
